<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>高仿QQ运动的周报界面 | 谢汉杰</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">高仿QQ运动的周报界面</h1><a id="logo" href="/.">谢汉杰</a><p class="description">保持愚蠢，保持饥饿</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">高仿QQ运动的周报界面</h1><div class="post-meta">Oct 22, 2016<span> | </span><span class="category"><a href="/categories/Android自定义/">Android自定义</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><p>这次高仿的是QQ运动的周报界面的网图。这个控件刚开始的时候以为代码量不大，没想到一路下来界面代码在加上动画代码还是蛮多的。好了老规矩先上图：<br><img src="http://upload-images.jianshu.io/upload_images/925576-08ae515a0f3bcd81.gif?imageMogr2/auto-orient/strip" alt="效果图.gif"><br>效果还是和qq的才不多吧。 1. 首先我把各个变量都贴出来以便在后续中你们可以更好理解代码的意思：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">//屏幕的宽度 </div><div class="line">private int mScreemWidth; </div><div class="line">//屏幕的高度 </div><div class="line">private int mScreemHight;</div><div class="line"> //圆的线 </div><div class="line">private Paint mCirclePaint; </div><div class="line">//圆区域的颜色 </div><div class="line">private Paint mCirclePaintColor; </div><div class="line">//虚线 </div><div class="line">private Paint mLineCircle;</div><div class="line"> //圆点 </div><div class="line">private Paint mCircleHoldPaint; </div><div class="line">//画字体 </div><div class="line">private Paint mCenterCircle; </div><div class="line">//最外的圆的透明度 </div><div class="line">private int mCircleAlpha1=0; </div><div class="line">//中间的圆的透明度 </div><div class="line">private int mCircleAlpha2=0; </div><div class="line">//最内的圆的透明度 </div><div class="line">private int mCircleAlpha3=0; </div><div class="line">//好友排名 </div><div class="line">private int mFriendDranking=0; </div><div class="line">//达标天数 </div><div class="line">private int mStandardDay=0; </div><div class="line">//平均步数 </div><div class="line">private int mAverageCount=0; </div><div class="line">//好友排名的X轴坐标 </div><div class="line">private float mFriendDrankingX=0; </div><div class="line">//好友排名的Y轴坐标 </div><div class="line">private float mFriendDrankingY=0; </div><div class="line">//平均步数的X轴坐标</div><div class="line">private float mStandardDayX=0; </div><div class="line">//平均步数的Y轴坐标 </div><div class="line">private float mStandardDayY=0;</div><div class="line"> //达标天数的X轴坐标 </div><div class="line">private float mAverageCountX=0; </div><div class="line">//达标天数的Y轴坐标 </div><div class="line">private float mAverageCountY=0; </div><div class="line">//临时的View的半径 </div><div class="line">private int tempCircleRadius=0; </div><div class="line">//View的半径 </div><div class="line">private int circleRadius=0; </div><div class="line">//每个圆圈的间隔 </div><div class="line">private float marginCircleSize=0; </div><div class="line">//圆的颜色 </div><div class="line">private int circleColor=0; </div><div class="line">//朋友区域的颜色 </div><div class="line">private int friendColor; </div><div class="line">//平均步数区域的颜色 </div><div class="line">private int averageColor; </div><div class="line">//达标天数区域的颜色 </div><div class="line">private int standardColor; </div><div class="line">//总步数 </div><div class="line">private String allStep; </div><div class="line">//好友排名</div><div class="line">private String firendDrank; </div><div class="line">//达标天数 </div><div class="line">private String standarDay; </div><div class="line">//平均步数 </div><div class="line">private String averageCount; </div><div class="line">//波浪动画的数值 </div><div class="line">private int waveData=-30; </div><div class="line">//中间文字翻转动画的数值 </div><div class="line">private float centerData=0; </div><div class="line">//画波浪的看门狗 </div><div class="line">private boolean waveWatchDag=false; </div><div class="line">//画虚线的看门狗 </div><div class="line">private boolean lineWatchDag=false; </div><div class="line">//各点解释的看门狗 </div><div class="line">private boolean expainWatchDag=false; </div><div class="line">//中心圆的内容的看门狗 </div><div class="line">private boolean centerWatchDag=false; </div><div class="line">//解释的字符串 </div><div class="line">private String averageCountTxt=&quot;平均步数&quot;; </div><div class="line">private String friendDrankTxt=&quot;好友排名&quot;; </div><div class="line">private String standarDayTxt=&quot;达标天数&quot;; </div><div class="line">private String theyCount=&quot;本周总步数&quot;; </div><div class="line">private String tip=&quot;步&quot;;</div></pre></td></tr></table></figure></p>
<p>2.有点多了，其次就是测量View的大小的onMeasure():<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">@Override protected void onMeasure(</div><div class="line">int widthMeasureSpec, int heightMeasureSpec) &#123;</div><div class="line"> int widthModel=MeasureSpec.getMode(widthMeasureSpec); </div><div class="line"> int heightModel=MeasureSpec.getMode(heightMeasureSpec); </div><div class="line"> int measureWidth=MeasureSpec.getSize(widthMeasureSpec); </div><div class="line"> int measureHeight=MeasureSpec.getSize(heightMeasureSpec); </div><div class="line"> int width; </div><div class="line"> int height; </div><div class="line">   if(widthModel==MeasureSpec.EXACTLY)&#123; </div><div class="line">     width=measureWidth; </div><div class="line">   &#125;else&#123; </div><div class="line">    width=getPaddingLeft()+getPaddingRight()+measureWidth;</div><div class="line">   &#125;</div><div class="line">   if(heightModel==MeasureSpec.EXACTLY)&#123; </div><div class="line">    height=measureHeight; </div><div class="line">   &#125;else&#123; </div><div class="line">    height=(getPaddingLeft()+getPaddingRight()+measureHeight)/2; </div><div class="line">  &#125; </div><div class="line">   setMeasuredDimension(width,height); </div><div class="line">  loadAnimator(); </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> 3.这里当设置大小为wrap_content的时候，View的宽度的话是用屏幕的的宽，而View的高的话是屏幕的高度的一半。当View的大小生成之后会调用onSizeChange()方法，具体操作如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">@Override </div><div class="line">protected void onSizeChanged(int w, int h, int oldw, int oldh) &#123; </div><div class="line">super.onSizeChanged(w, h, oldw, oldh); </div><div class="line">mScreemWidth=w; </div><div class="line">mScreemHight=h;</div><div class="line">  //得出最大的圆的半径 </div><div class="line">  if(mScreemWidth&gt;mScreemHight)&#123; </div><div class="line">     circleRadius=Float.valueOf((w/3.4)+&quot;&quot;).intValue(); </div><div class="line">  &#125;else&#123; </div><div class="line">    circleRadius=Float.valueOf((h/3.4)+&quot;&quot;).intValue(); </div><div class="line">  &#125; </div><div class="line"> if(tempCircleRadius!=0&amp;&amp;tempCircleRadius&lt;=circleRadius)&#123;          </div><div class="line">    circleRadius=tempCircleRadius; </div><div class="line"> &#125; </div><div class="line">   //得出每个圆的间隔 </div><div class="line">   marginCircleSize=circleRadius/6; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当View的宽度大于View的高度时，最外边的圆的半径就是w/3.4，反之当View的高度大于View的宽度时，最外边的圆的半径就是h/3.4,而每个圆的间隔就是圆半径的六分之一。4.接着就是最重要的onDraw()方法了，代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@Override protected void onDraw(Canvas canvas) &#123; </div><div class="line">canvas.translate(getWidth()/2,getHeight()/2-(circleRadius/6)); </div><div class="line">  canvas.save(); </div><div class="line">  //画出三条圆圈 </div><div class="line">  drawCircle(canvas);</div><div class="line">  //画出波浪图形 </div><div class="line">  drawWaves(canvas); </div><div class="line">  //画虚线 </div><div class="line">  drawDottedLine(canvas); </div><div class="line">  //画点 </div><div class="line">  drawCircleHold(canvas); </div><div class="line">  //画解释的内容 </div><div class="line">  drawExpain(canvas); </div><div class="line">  //画中心圆的内容 </div><div class="line">  centerCircleContent(canvas); </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>首先把canvas的原点移到X轴为宽度的一半，Y轴为高度的一半再减去六分之一的半径，保存canvas的状态。接着就一个个说这里面的每一个方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">//画出三条圆圈 </div><div class="line">public void drawCircle(Canvas canvas)&#123; </div><div class="line">  //画出最大的圆 </div><div class="line">  mCirclePaint.setAlpha(mCircleAlpha1);</div><div class="line">  canvas.drawCircle(0,0,circleRadius,mCirclePaint); </div><div class="line">  //画出第二大的圆 </div><div class="line">  mCirclePaint.setAlpha(mCircleAlpha2); </div><div class="line">  canvas.drawCircle(0,0,circleRadius-marginCircleSize,mCirclePaint); </div><div class="line">  mCirclePaintColor.setColor(Color.parseColor(&quot;#F1FCFE&quot;)); </div><div class="line">  mCirclePaintColor.setAlpha(mCircleAlpha2); </div><div class="line">  canvas.drawCircle(0,0,circleRadius-marginCircleSize-2,mCirclePaintColor); </div><div class="line">  //画出第三大的圆 </div><div class="line">  mCirclePaint.setAlpha(mCircleAlpha3); </div><div class="line">  canvas.drawCircle(0,0,circleRadius-marginCircleSize*2,mCirclePaint); </div><div class="line">  mCirclePaintColor.setColor(Color.parseColor(&quot;#E7F9FE&quot;)); </div><div class="line">  mCirclePaintColor.setAlpha(mCircleAlpha3); </div><div class="line">  canvas.drawCircle(0,0,circleRadius-marginCircleSize*2-2,mCirclePaintColor); </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个方法是比较简单的，就是画出三个圆圈，每个圆圈的间隔就是前面所初始化的marginCircleSize，圆圈的圆心就是canvas的原点，之前我们移动过原点了。第二和第三个圆圈里面还配有圆的背景，效果如下图：<br><img src="http://upload-images.jianshu.io/upload_images/925576-8762fcd94edd4f08.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img1.PNG"><br>接着就是画出波浪图形的方法 drawWaves(canvas)代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"> //画出波浪图形 </div><div class="line">public void drawWaves(Canvas canvas)&#123;</div><div class="line"> if(!waveWatchDag)&#123;</div><div class="line">     return ;</div><div class="line"> &#125; </div><div class="line"></div><div class="line">canvas.rotate(waveData);</div><div class="line">float inCircleRadius=circleRadius-marginCircleSize*3; </div><div class="line">//算出最上面的点 </div><div class="line">float topPointX=0; </div><div class="line">float topPointY=-inCircleRadius; </div><div class="line">//算出左下角的点 </div><div class="line">float leftBottpmPointX=-(float)Math.sqrt(Math.pow(inCircleRadius,2)-Math.pow(inCircleRadius/2,2));</div><div class="line">float leftBottomPointY=inCircleRadius/2; </div><div class="line">//算出右小角的点 </div><div class="line">float rightBottomPointX=-leftBottpmPointX;</div><div class="line">float rightBottomPointY=inCircleRadius/2;</div><div class="line">//得到好友排名半径</div><div class="line">float mFriendDrankingData=circleValue(mFriendDranking); </div><div class="line">//得到达标天数半径 </div><div class="line">float mStandarDayData=circleValue(mStandardDay); </div><div class="line">//得到平均步数半径</div><div class="line">float mAverageCountData=circleValue(mAverageCount); </div><div class="line"></div><div class="line">/*画好友排名*/ </div><div class="line">//得出左上角的圆的坐标</div><div class="line">float[] mFriendDrankingPoint=calculatePoint(mFriendDrankingData); </div><div class="line">//好友排名的X轴坐标 </div><div class="line">mFriendDrankingX=-mFriendDrankingPoint[0]; </div><div class="line">//好友排名的Y轴坐标 </div><div class="line">mFriendDrankingY=-mFriendDrankingPoint[1]; </div><div class="line">//画出还有排名的波浪线 </div><div class="line">Path mFriendDrankingPath=new Path(); </div><div class="line">mFriendDrankingPath.moveTo(leftBottpmPointX,leftBottomPointY); </div><div class="line">mFriendDrankingPath.lineTo(mFriendDrankingX-6,mFriendDrankingY-6); </div><div class="line">mFriendDrankingPath.lineTo(topPointX,topPointY); </div><div class="line">mFriendDrankingPath.lineTo(topPointX+10,topPointY+10); </div><div class="line">mCirclePaintColor.setPathEffect(new CornerPathEffect(20)); </div><div class="line">mCirclePaintColor.setColor(friendColor); </div><div class="line">canvas.drawPath(mFriendDrankingPath,mCirclePaintColor);</div><div class="line"></div><div class="line"> /*画达标天数*/ </div><div class="line">//得出右上角的圆的坐标</div><div class="line"> float[] mStandarDayPoint=calculatePoint(mStandarDayData);</div><div class="line"> //达标天数的X轴坐标</div><div class="line"> mStandardDayX=mStandarDayPoint[0]; </div><div class="line">//达标天数的Y轴坐标 </div><div class="line">mStandardDayY=-mStandarDayPoint[1];</div><div class="line"> //画出还有达标天数的波浪线 </div><div class="line">Path mStandarDayPath=new Path();</div><div class="line"> mStandarDayPath.moveTo(topPointX,topPointY); </div><div class="line">mStandarDayPath.lineTo(mStandardDayX+6,mStandardDayY-6); </div><div class="line">mStandarDayPath.lineTo(rightBottomPointX,rightBottomPointY); </div><div class="line">mStandarDayPath.lineTo(rightBottomPointX-10,rightBottomPointY+10); </div><div class="line">mCirclePaintColor.setColor(standardColor); </div><div class="line">canvas.drawPath(mStandarDayPath,mCirclePaintColor); </div><div class="line"></div><div class="line">/*平均步数*/</div><div class="line">//平均步数的X轴坐标 </div><div class="line">mAverageCountX=0; </div><div class="line">//平均步数的Y轴坐标 </div><div class="line">mAverageCountY=mAverageCountData;</div><div class="line">//画出还有平均步数的波浪线 </div><div class="line">Path mAverageCountPath=new Path();</div><div class="line">mAverageCountPath.moveTo(rightBottomPointX,rightBottomPointY); </div><div class="line">mAverageCountPath.lineTo(topPointX,mAverageCountData+8); </div><div class="line">mAverageCountPath.lineTo(leftBottpmPointX,leftBottomPointY); </div><div class="line">mAverageCountPath.lineTo(leftBottpmPointX+10,leftBottomPointY+10); </div><div class="line">mCirclePaintColor.setColor(averageColor); </div><div class="line">canvas.drawPath(mAverageCountPath,mCirclePaintColor);</div><div class="line"> //最里面的圆 mCirclePaintColor.setColor(Color.WHITE); </div><div class="line">canvas.drawCircle(0,0,circleRadius-marginCircleSize*3,mCirclePaintColor); </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这方法里最核心的就是数学计算了，整个View有3个波浪区域，各占一个圆的三分之一，所以第一步就是计算出这个圆的左下角,右小角和正上角的三个点，如图<br><img src="http://upload-images.jianshu.io/upload_images/925576-5c3e3e7c151a9cd8.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img2.PNG">的蓝色点所示。具体代码见注释。在通过circleValue算出波浪线的半径：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> //算出弧线区域的半径 </div><div class="line">public float circleValue(int mDataDranking)&#123; </div><div class="line">if(mDataDranking==1)&#123; </div><div class="line">    return circleRadius-marginCircleSize*2; </div><div class="line">&#125;else if(mDataDranking==2)&#123; </div><div class="line">    return circleRadius-marginCircleSize; </div><div class="line">&#125;else if(mDataDranking==3)&#123; </div><div class="line">    return circleRadius; </div><div class="line">&#125;else&#123; </div><div class="line">    return circleRadius-marginCircleSize*2;</div><div class="line"> &#125; &#125;</div></pre></td></tr></table></figure></p>
<p>然后通过calculatePoint()方法来各个波浪区域对应的顶点，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//算出右上角或左上角的坐标 </div><div class="line">public float[] calculatePoint(float radius)&#123; </div><div class="line">   float[] result=new float[2]; </div><div class="line">   float pointY=radius/2; </div><div class="line">   float pointX=(float)Math.sqrt(Math.pow(radius,2)-Math.pow(pointY,2)); </div><div class="line">   result[0]=pointX; </div><div class="line">   result[1]=pointY; </div><div class="line">   return result; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最后转化为形象的图就是:<br><img src="http://upload-images.jianshu.io/upload_images/925576-eb3181385fef577e.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img3.PNG">接着用Path把各个区域的点连起来就是形成区域，不过现在还是尖角，要把它变成原角就要用mCirclePaintColor.setPathEffect(new CornerPathEffect(20));方法，这样各个边的连接处都可以转换成圆角，可是因为是圆角所以到不到圆圈的边，这时候你要对你的顶点进行微调，所以我再顶点都进行了减6或者加6的操作。至于我这个6是怎么得出来的,我用的等比例的数学方法来求出来的，到时有优化我可以把我的方法用代码表示出来。至此，重要的就说完了，剩下的只是用canvas和path和paint画出来就是了。效果如下：<br><img src="http://upload-images.jianshu.io/upload_images/925576-ce3162a552d959a9.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img4.PNG"><br>接着就是画虚线的方法了drawDottedLine(canvas)代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"> //画圆点和虚线 </div><div class="line">public void drawDottedLine(Canvas canvas)&#123; </div><div class="line">    if(!lineWatchDag)&#123; </div><div class="line">       return; </div><div class="line">    &#125; </div><div class="line">   for(int i=0;i&lt;3;i++)&#123; </div><div class="line">      canvas.rotate(120); </div><div class="line">    if(i==0)&#123; </div><div class="line">    //画好友排名的虚线</div><div class="line">    mLineCircle.setTextSize(18); </div><div class="line">    mLineCircle.setColor(friendColor);     </div><div class="line">   drawDottedLine(canvas,judgeDotte(mFriendDranking)); </div><div class="line">    &#125;else if(i==1)&#123; </div><div class="line">   //画达标天数的虚线 </div><div class="line">   mLineCircle.setColor(standardColor); </div><div class="line">   drawDottedLine(canvas,judgeDotte(mStandardDay));</div><div class="line">   &#125;else if(i==2)&#123; </div><div class="line">   //画平均步数的虚线 </div><div class="line">  mLineCircle.setColor(averageColor); </div><div class="line">  drawDottedLine(canvas,judgeDotte(mAverageCount)); </div><div class="line">&#125; &#125; </div><div class="line">  canvas.restore(); </div><div class="line">&#125;  </div><div class="line"></div><div class="line">//判断虚线 </div><div class="line">public List&lt;Float&gt; judgeDotte(int value)&#123; List&lt;Float&gt; temp=new ArrayList&lt;&gt;(); </div><div class="line">     if(value==1)&#123; </div><div class="line">       //当为1时,波浪顶点到第三个圆  </div><div class="line">      temp.add(circleRadius-marginCircleSize*2); </div><div class="line">      temp.add((float)circleRadius); </div><div class="line">      temp.add(circleRadius-marginCircleSize*3); </div><div class="line">    &#125;else if(value==2)&#123; </div><div class="line">     //当为2时,波浪顶点到第二个圆 </div><div class="line">     temp.add(circleRadius-marginCircleSize); </div><div class="line">     temp.add((float)circleRadius); </div><div class="line">     temp.add(circleRadius-marginCircleSize*3); </div><div class="line">   &#125;else if(value==3)&#123; </div><div class="line">   //当为3时,波浪顶点到第一个圆</div><div class="line">    temp.add(circleRadius-marginCircleSize*3);</div><div class="line">    temp.add((float)circleRadius); </div><div class="line">  &#125; </div><div class="line">   return temp; </div><div class="line">&#125; </div><div class="line">//画虚线 </div><div class="line">public void drawDottedLine(Canvas canvas,List&lt;Float&gt; data)&#123; </div><div class="line">    if(data.size()==2)&#123;</div><div class="line">       /*当数值是最大的是时候也就是3*/</div><div class="line">      mLineCircle.setColor(Color.WHITE);</div><div class="line">      Path path=new Path(); </div><div class="line">     path.moveTo(0,data.get(0)); </div><div class="line">     path.lineTo(0,data.get(1));</div><div class="line">     canvas.drawPath(path,mLineCircle);</div><div class="line">     return ; </div><div class="line">&#125;else&#123; </div><div class="line">    /*当数值在1和2的时候*/ </div><div class="line">   //画出数值外的虚线 </div><div class="line">   Path pathOut=new Path(); </div><div class="line">   pathOut.moveTo(0,data.get(0));</div><div class="line">   pathOut.lineTo(0,data.get(1));</div><div class="line">   mLineCircle.setPathEffect(new DashPathEffect(new float[]&#123;7,5,7,5&#125;,5)); </div><div class="line">  canvas.drawPath(pathOut,mLineCircle); </div><div class="line">  //画出数值内的虚线 </div><div class="line">  Path pathIn=new Path(); </div><div class="line">  pathIn.moveTo(0,data.get(1)); </div><div class="line">  pathIn.lineTo(0,data.get(2)); </div><div class="line">  mLineCircle.setColor(Color.WHITE); </div><div class="line">  canvas.drawPath(pathIn,mLineCircle); </div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>首先canvas通过每次旋转120度来画出每一条波浪线，通过judgeDotte()方法得出波浪线三个点对应的Y轴的坐标，假如judgeDotte返回的个数是两个的话那就是证明顶点在最外面的圆，假如是3个的话就画出顶点之外和顶点之内的线就可以了，代码注释已经很详细了，效果图如下：<br><img src="http://upload-images.jianshu.io/upload_images/925576-323913dd364865f2.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img5.PNG"><br>接着是画虚线上的圆点，drawCircleHold(Canvas canvas)代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">//画虚线上的圆点 </div><div class="line">public void drawCircleHold(Canvas canvas)&#123; </div><div class="line">  if(!lineWatchDag)&#123;</div><div class="line">     return;</div><div class="line">  &#125;</div><div class="line"> float[] yuan1=calculatePoint(circleRadius-marginCircleSize*2); </div><div class="line"> float[] yuan2=calculatePoint(circleRadius-marginCircleSize); </div><div class="line"> float[] yuan3=calculatePoint(circleRadius); </div><div class="line">//画好友排名的圆点 </div><div class="line">drawCircleHoldImpl(-yuan1[0],-yuan1[1],-yuan2[0],-yuan2[1], -yuan3[0],-yuan3[1],mFriendDranking,canvas,friendColor);</div><div class="line"> //画达标天数的圆点 </div><div class="line">drawCircleHoldImpl(yuan1[0],-yuan1[1],yuan2[0],-yuan2[1], yuan3[0],-yuan3[1],mStandardDay,canvas,standardColor);</div><div class="line"> //画平均步数的圆点 drawCircleHoldImpl(0,circleRadius-marginCircleSize*2,0,circleRadius-marginCircleSize, 0,circleRadius,mAverageCount,canvas,averageColor); </div><div class="line">expainWatchDag=true;</div><div class="line"> &#125; </div><div class="line">//画圆的具体的方法 </div><div class="line">public void drawCircleHoldImpl(float mCirlce1X,float mCircle1Y,float mCirlce2X,float mCircle2Y, float mCirlce3X,float mCircle3Y,int action,Canvas canvas,int color)&#123; </div><div class="line">mCircleHoldPaint.setColor(color); </div><div class="line">if(action==1)&#123; </div><div class="line">//当数值为3时画所有圆圈 canvas.drawCircle(mCirlce1X,mCircle1Y,8,mCircleHoldPaint); </div><div class="line">canvas.drawCircle(mCirlce2X,mCircle2Y,8,mCircleHoldPaint); </div><div class="line">&#125;else if(action==2)&#123;</div><div class="line"> //当数值为2时画中间的圆圈 </div><div class="line">canvas.drawCircle(mCirlce2X,mCircle2Y,8,mCircleHoldPaint);</div><div class="line"> &#125; </div><div class="line">//画一定要画的圆圈和圆点 </div><div class="line">canvas.drawCircle(mCirlce3X,mCircle3Y,8,mCircleHoldPaint); </div><div class="line">mCircleHoldPaint.setColor(Color.WHITE); </div><div class="line">canvas.drawCircle(mCirlce1X,mCircle1Y,6,mCircleHoldPaint); </div><div class="line">canvas.drawCircle(mCirlce2X,mCircle2Y,6,mCircleHoldPaint); </div><div class="line">canvas.drawCircle(mCirlce3X,mCircle3Y,6,mCircleHoldPaint); </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里同样注释也是很详细的，整个思路就是通过calculatePoint()算出三个圆点的坐标，在通过传进去的数值来要画多少个圆圈，而原点是不管数值多少都要画的。效果图如下：<br><img src="http://upload-images.jianshu.io/upload_images/925576-8b9b623f2a29804e.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img6.PNG"><br>接着就是画解释的内容drawExpain(Canvas canvas)代码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"> //画解释的内容 </div><div class="line">public void drawExpain(Canvas canvas)&#123; </div><div class="line">    if(!expainWatchDag)&#123;</div><div class="line">        return ;</div><div class="line">    &#125; </div><div class="line">//间隔 int margin=circleRadius/5; </div><div class="line">//画平均步数和对应的数值 </div><div class="line">   Rect txtRect=new Rect(); </div><div class="line">   mCenterCircle.setColor(Color.BLACK); </div><div class="line">   mCenterCircle.setTextSize(circleRadius/6); </div><div class="line">   mCenterCircle.setTypeface(Typeface.SANS_SERIF); </div><div class="line">   canvas.drawText(averageCount,0,circleRadius+margin,mCenterCircle); </div><div class="line">   mCenterCircle.setColor(friendColor); mCenterCircle.setTextSize(circleRadius/10); </div><div class="line">  mCenterCircle.getTextBounds(averageCountTxt,0,averageCountTxt.length(),txtRect); </div><div class="line">  canvas.drawText(averageCountTxt,0,circleRadius+margin+(txtRect.bottom-   txtRect.top),mCenterCircle);</div><div class="line"> </div><div class="line">//画好友排名和对应的数值</div><div class="line">  mCenterCircle.setColor(Color.BLACK); </div><div class="line">  mCenterCircle.setTextSize(circleRadius/6); </div><div class="line">  canvas.drawText(firendDrank,-circleRadius,-(circleRadius-  marginCircleSize),mCenterCircle); </div><div class="line">  mCenterCircle.setColor(friendColor); </div><div class="line">  mCenterCircle.setTextSize(circleRadius/10); </div><div class="line">  mCenterCircle.getTextBounds(friendDrankTxt,0,friendDrankTxt.length(),txtRect); </div><div class="line">  canvas.drawText(friendDrankTxt,-circleRadius,-(circleRadius-marginCircleSize)+(txtRect.bottom-txtRect.top),mCenterCircle);</div><div class="line">  //画达标天数和对应的数值 </div><div class="line">  mCenterCircle.setColor(Color.BLACK); </div><div class="line">  mCenterCircle.setTextSize(circleRadius/6); </div><div class="line">  canvas.drawText(standarDay,circleRadius,-(circleRadius-  marginCircleSize),mCenterCircle); </div><div class="line">  mCenterCircle.setColor(friendColor); </div><div class="line">  mCenterCircle.setTextSize(circleRadius/10); </div><div class="line">  mCenterCircle.getTextBounds(friendDrankTxt,0,friendDrankTxt.length(),txtRect); </div><div class="line">  canvas.drawText(standarDayTxt,circleRadius,-(circleRadius-marginCircleSize)+(txtRect.bottom-txtRect.top),mCenterCircle); centerWatchDag=true; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>看起来代码有点多，其实是最简单的，就是确定好友排名的坐标(-circleRadius,-(circleRadius-marginCircleSize)),int margin=circleRadius/5,平均步数的坐标(0,circleRadius+margin),达标天数的坐标(circleRadius,-(circleRadius-marginCircleSize))来进行drawText的操作而已，没什么可以说的，Rect是得出字体大小的，具体看上面代码。效果如下图：<br><img src="http://upload-images.jianshu.io/upload_images/925576-9fa29418c9dd9e9c.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img7.PNG"><br>最后就是画中心圆的内容的centerCircleContent(canvas)了，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">//画中心圆的内容 </div><div class="line">public void centerCircleContent(Canvas canvas)&#123; </div><div class="line">if(!centerWatchDag)&#123; </div><div class="line">return ; </div><div class="line">&#125; </div><div class="line">//画出颜色渐变的圆圈 </div><div class="line">  canvas.rotate(140); </div><div class="line">  float centerSize=circleRadius-marginCircleSize*3-(circleRadius/20); </div><div class="line">  mCenterCircle.setShader(new SweepGradient(0,0,new int[]&#123;   friendColor,friendColor,standardColor,averageColor&#125;,null)); </div><div class="line">  canvas.drawCircle(0,0,centerSize,mCenterCircle); </div><div class="line">  canvas.rotate(-140); </div><div class="line">//画出运动的总步数 </div><div class="line">  mCenterCircle.setShader(null); </div><div class="line">  mCenterCircle.setColor(friendColor); </div><div class="line">  mCenterCircle.setTextSize(circleRadius/4);     </div><div class="line">  mCenterCircle.setTextAlign(Paint.Align.CENTER); </div><div class="line">  Rect numRect=new Rect();   </div><div class="line">  mCenterCircle.getTextBounds(allStep,0,allStep.length(),numRect); </div><div class="line">  Camera camera=new Camera(); camera.rotateY(centerData); </div><div class="line">  camera.applyToCanvas(canvas); </div><div class="line">  canvas.drawText(allStep,0,(numRect.bottom-numRect.top)/2,mCenterCircle); </div><div class="line">//画出总运动步数右边的字</div><div class="line">  Rect tipRect=new Rect(); </div><div class="line"> mCenterCircle.setTextSize(circleRadius/12); </div><div class="line"> mCenterCircle.getTextBounds(tip,0,tip.length(),tipRect); </div><div class="line"> canvas.drawText(tip,(numRect.right-numRect.left)/2+(tipRect.right-tipRect.left)/2+5 ,(numRect.bottom-numRect.top)/2-3,mCenterCircle); </div><div class="line">//画出总运动步数下面的提示 </div><div class="line"> Rect theyRect=new Rect(); </div><div class="line"> mCenterCircle.getTextBounds(theyCount,0,theyCount.length(),theyRect); </div><div class="line"> float marginBottom=circleRadius/12; </div><div class="line"> mCenterCircle.setTextSize(circleRadius/11); </div><div class="line"> canvas.drawText(theyCount,0,marginBottom+(numRect.bottom-numRect.top)/2 +(theyRect.bottom-theyRect.top)/2,mCenterCircle);</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>中心圆的内容里实现的大概思路画解释的内容的思路都差不多，我觉得值得讲的就是这个Camera类了，这里的Camera类可不是相机里的Camera类，他可以实现Camera的旋转缩放的功能，是一个十分强大的类，而<code>camera.rotateY(centerData)</code>就是设置Y轴旋转的效果的关键代码。其次就是用<code>mCenterCircle.setShader(new SweepGradient(0,0,new int[]{ friendColor,friendColor,standardColor,averageColor},null));</code>来实现圆圈颜色的渐变功能的关键代码，里面还可以实现更多效果，这就需要小伙伴们用外的时间学了。最后效果如下:<br><img src="http://upload-images.jianshu.io/upload_images/925576-113243bf8482b852.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img8.PNG"><br>至此整个绘画就结束了，接着就是动画效果，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"> //启动动画的方法 </div><div class="line">public void loadAnimator()&#123;</div><div class="line"> final ValueAnimator alphaAmimator3=ValueAnimator.ofInt(0,225);</div><div class="line"> final ValueAnimator alphaAmimator2=ValueAnimator.ofInt(0,225); </div><div class="line"> final ValueAnimator wavesAminator=ValueAnimator.ofInt(-30,0); </div><div class="line"> final ValueAnimator centerAnimator=ValueAnimator.ofFloat(0,360); </div><div class="line"> ValueAnimator alphaAmimator1=ValueAnimator.ofInt(0,225); </div><div class="line"> centerAnimator.setDuration(1000);</div><div class="line"> centerAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;   </div><div class="line">  @Override </div><div class="line">  public void onAnimationUpdate(ValueAnimator animation) &#123; </div><div class="line">     centerData=(float)animation.getAnimatedValue(); postInvalidate();</div><div class="line">   &#125; </div><div class="line">  &#125;);</div><div class="line">  wavesAminator.setDuration(1000); </div><div class="line">  wavesAminator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;    </div><div class="line">  @Override </div><div class="line">  public void onAnimationUpdate(ValueAnimator animation) &#123; </div><div class="line">   waveData=(int)animation.getAnimatedValue(); </div><div class="line">   waveWatchDag=true; </div><div class="line">   if(waveData==0&amp;&amp;lineWatchDag==false)&#123; </div><div class="line">      lineWatchDag=true; centerAnimator.start(); </div><div class="line">   &#125; </div><div class="line">   postInvalidate(); </div><div class="line"> &#125; &#125;); </div><div class="line">alphaAmimator3.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123; @Override </div><div class="line">public void onAnimationUpdate(ValueAnimator animation) &#123; </div><div class="line">   mCircleAlpha3=(int)animation.getAnimatedValue(); </div><div class="line">   postInvalidate(); </div><div class="line">   if(mCircleAlpha3==225)&#123; </div><div class="line">      wavesAminator.start(); </div><div class="line">  &#125;</div><div class="line"> &#125;</div><div class="line"> &#125;);</div><div class="line"> alphaAmimator3.setDuration(250); </div><div class="line"> alphaAmimator2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123; @Override </div><div class="line">public void onAnimationUpdate(ValueAnimator animation) &#123; </div><div class="line">   mCircleAlpha2=(int)animation.getAnimatedValue(); </div><div class="line">   postInvalidate();</div><div class="line">   if(mCircleAlpha2==225)&#123;</div><div class="line">       alphaAmimator3.start(); </div><div class="line">   &#125; </div><div class="line"> &#125; &#125;); </div><div class="line">alphaAmimator2.setDuration(250); </div><div class="line">alphaAmimator1.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123; @Override </div><div class="line">public void onAnimationUpdate(ValueAnimator animation) &#123; </div><div class="line">    mCircleAlpha1=(int)animation.getAnimatedValue(); postInvalidate();    </div><div class="line">   if(mCircleAlpha1==225)&#123; </div><div class="line">       alphaAmimator2.start(); </div><div class="line">   &#125; </div><div class="line">&#125;</div><div class="line">&#125;); </div><div class="line">alphaAmimator1.setDuration(250); </div><div class="line">alphaAmimator1.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其实就是通过ValueAnimator不断的生成状态量然后调用postInvalidate()不断的刷新View即可实现。最后要想更详细的了解整个流程请看源码吧。<br>奉上<strong><a href="https://github.com/jack921/WebChart" target="_blank" rel="external">源码</a></strong>。如果对你有帮助就请给我给星星或喜欢吧</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://jack921.win/2016/10/22/高仿QQ运动的周报界面/" data-id="cj23dxnq4000atcvldc42lppg" class="article-share-link">分享</a><div class="tags"><a href="/tags/Android自定义/">Android自定义</a></div><div class="post-nav"><a href="/2016/10/05/模仿企鹅FM播放主页面滑动动态改变各视图的大小/" class="pre">模仿企鹅FM播放主页面滑动动态改变各视图的大小</a><a href="/2016/12/23/一个漂亮的干货集中营客户端的生成，集合了干货api的大部分功能/" class="next">一个漂亮的干货集中营客户端的生成，集合了干货api的大部分功能</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://jack921.win"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android自定义/">Android自定义</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/React-Native/">React Native</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Android自定义/" style="font-size: 15px;">Android自定义</a> <a href="/tags/Android自定义控件/" style="font-size: 15px;">Android自定义控件</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Android界面/" style="font-size: 15px;">Android界面</a> <a href="/tags/Gank-Android-客户端/" style="font-size: 15px;">Gank Android 客户端</a> <a href="/tags/android蓝牙4-0/" style="font-size: 15px;">android蓝牙4.0</a> <a href="/tags/android自定义控件/" style="font-size: 15px;">android自定义控件</a> <a href="/tags/react-native/" style="font-size: 15px;">react native</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/04/16/教你实现最简单的QQ消息item侧滑菜单/">教你实现最简单的QQ消息item侧滑菜单</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/13/android蓝牙4-0的知识要点/">android蓝牙4.0的知识要点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/24/基于豆瓣和妹子的api用React Native写的demo for android/">基于豆瓣和妹子的api用React Native写的demo for android</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/23/一个漂亮的干货集中营客户端的生成，集合了干货api的大部分功能/">一个漂亮的干货集中营客户端的生成，集合了干货api的大部分功能</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/22/高仿QQ运动的周报界面/">高仿QQ运动的周报界面</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/05/模仿企鹅FM播放主页面滑动动态改变各视图的大小/">模仿企鹅FM播放主页面滑动动态改变各视图的大小</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/04/自定义天气显示温度变化的LinearChart控件/">自定义天气显示温度变化的LinearChart控件</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/25/模仿QQ运动item的界面/">模仿QQ运动item的界面</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/高仿支付宝9-9-2版本生活模块界面来讲解CoordinatorLayout，AppBarLayout，CollapsingToolbarLayout/">高仿支付宝9.9.2版本生活模块界面来讲解CoordinatorLayout，AppBarLayout，CollapsingToolbarLayout</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/11/Android自定义钟表/">Android自定义钟表</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.jianshu.com/u/077c44fa1dff" title="Jack的简书" target="_blank">Jack的简书</a><ul></ul><a href="http://blog.csdn.net/u011992900" title="Jack的csdn" target="_blank">Jack的csdn</a><ul></ul><a href="https://github.com/jack921" title="Jack的github" target="_blank">Jack的github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">谢汉杰.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>